
% -------------------------------------------------------
%  Common Styles and Formattings
% -------------------------------------------------------


\usepackage{pgfgantt}

\usepackage{amssymb,amsmath}
\usepackage[colorlinks,linkcolor=blue,citecolor=blue]{hyperref}
\usepackage[usenames,dvipsnames]{pstricks}
\usepackage{graphicx,subcaption,wrapfig}
\usepackage{geometry,fancyhdr}
\usepackage[mathscr]{euscript}
\usepackage{multicol}
\usepackage{array}
\usepackage{enumitem}
\usepackage{setspace}
\usepackage{afterpage}
\usepackage{longtable}
\usepackage{listings}
\usepackage{hhline}



\usepackage{placeins}

\usepackage[table]{colortbl}

\usepackage{algorithmicx,algorithm}

\usepackage[localise=on,extrafootnotefeatures]{xepersian}
\usepackage[noend]{algpseudocode}
\input{styles/alg-fa}


% -------------------- Page Layout --------------------


\newgeometry{top=3.5cm,bottom=3.5cm,left=2.5cm,right=3cm,headheight=25pt}

\renewcommand{\baselinestretch}{1.4}
\linespread{1.6}
\setlength{\parskip}{0.45em}

\fancyhf{}
\rhead{\leftmark}
\lhead{\thepage}


% -------------------- Fonts --------------------

\settextfont[
Scale=1.09,
Extension=.ttf, 
Path=styles/fonts/,
BoldFont=XB NiloofarBd,
ItalicFont=XB NiloofarIt,
BoldItalicFont=XB NiloofarBdIt
]{XB Niloofar}

\setdigitfont[
Scale=1.09,
Extension=.ttf, 
Path=styles/fonts/,
BoldFont=XB NiloofarBd,
ItalicFont=XB NiloofarIt,
BoldItalicFont=XB NiloofarBdIt
]{XB Niloofar}

\defpersianfont\sayeh[
Scale=1,
Path=styles/fonts/
]{XB Kayhan Pook}


% -------------------- Styles --------------------


\SepMark{-}
\renewcommand{\labelitemi}{$\small\bullet$}



% -------------------- Environments --------------------


\newtheorem{قضیه}{قضیه‌ی}[chapter]
\newtheorem{لم}[قضیه]{لم}
\newtheorem{ادعا}[قضیه]{ادعای}
\newtheorem{مشاهده}[قضیه]{مشاهده‌ی}
\newtheorem{نتیجه}[قضیه]{نتیجه‌ی}
\newtheorem{مسئله}{مسئله‌ی}[chapter]
\newtheorem{تعریف}{تعریف}[chapter]
\newtheorem{مثال}{مثال}[chapter]


\newenvironment{اثبات}
{\begin{trivlist}\item[\hskip\labelsep{\em اثبات.}]}
	{\leavevmode\unskip\nobreak\quad\hspace*{\fill}{\ensuremath{{\square}}}\end{trivlist}}

\newenvironment{alg}[2]
{\begin{latin}\settextfont[Scale=1.0]{Times New Roman}
		\begin{algorithm}[t]\caption{#1}\label{algo:#2}\vspace{0.2em}\begin{algorithmic}[1]}
			{\end{algorithmic}\vspace{0.2em}\end{algorithm}\end{latin}}


% -------------------- Titles --------------------


\renewcommand{\listfigurename}{فهرست شکل‌ها}
\renewcommand{\listtablename}{فهرست جدول‌ها}
\renewcommand{\bibname}{\rl{{مراجع}\hfill}} 


% -------------------- Commands --------------------


\newcommand{\IN}{\ensuremath{\mathbb{N}}} 
\newcommand{\IZ}{\ensuremath{\mathbb{Z}}} 
\newcommand{\IQ}{\ensuremath{\mathbb{Q}}} 
\newcommand{\IR}{\ensuremath{\mathbb{R}}} 
\newcommand{\IC}{\ensuremath{\mathbb{C}}} 

\newcommand{\set}[1]{\left\{ #1 \right\}}
\newcommand{\seq}[1]{\left< #1 \right>}
\newcommand{\ceil}[1]{\left\lceil{#1}\right\rceil}
\newcommand{\floor}[1]{\left\lfloor{#1}\right\rfloor}
\newcommand{\card}[1]{\left|{#1}\right|}
\newcommand{\setcomp}[1]{\overline{#1}}
\newcommand{\provided}{\,:\,}
\newcommand{\divs}{\mid}
\newcommand{\ndivs}{\nmid}
\newcommand{\iequiv}[1]{\,\overset{#1}{\equiv}\,}
\newcommand{\imod}[1]{\allowbreak\mkern5mu(#1\,\,\text{پیمانه‌ی})}

\newcommand{\poly}{\mathop{\mathrm{poly}}}
\newcommand{\polylog}{\mathop{\mathrm{polylog}}}
\newcommand{\eps}{\varepsilon}

\newcommand{\lee}{\leqslant}
\newcommand{\gee}{\geqslant}
\renewcommand{\leq}{\lee}
\renewcommand{\le}{\lee}
\renewcommand{\geq}{\gee}
\renewcommand{\ge}{\gee}

\newcommand{\مهم}[1]{\textbf{#1}}
\renewcommand{\برچسب}{\label}

\newcommand{\REM}[1]{}
\renewcommand{\حذف}{\REM}
\newcommand{\لر}{\lr}
\newcommand{\کد}[1]{\lr{\tt #1}}
\newcommand{\پاورقی}[1]{\footnote{\lr{#1}}}



% -------------------- Dictionary --------------------


\newcommand{\dicalphabet}[1]{
	\begin{minipage}{\columnwidth}
		\centerline{\noindent\textbf{\large #1 }}
		\vspace{.5em}
	\end{minipage}
	\nopagebreak[4]
}

\newcommand{\dic}[2]{\noindent  #2 \dotfill  \lr{#1} \\ }


% ------------------------------ Images and Figures --------------------------

\graphicspath{{figs/}}
\setlength{\intextsep}{0pt}  % for float boxes
\renewcommand{\psscalebox}[1]{}  % for LaTeX Draw

\newcommand{\floatbox}[2]
{\begin{wrapfigure}{l}{#1}
		\centering #2 \end{wrapfigure}}

\newcommand{\centerfig}[2]
{\centering\scalebox{#2}{\input{figs/#1}}}

\newcommand{\fig}[3]
{\floatbox{#3}{\centerfig{#1}{#2}}}

\newcommand{\centerimg}[2]
{\vspace{1em}\begin{center}\includegraphics[width=#2]{figs/#1}\end{center}\vspace{-1.5em}}

\NewDocumentCommand{\img}{m m o}
{\begin{wrapfigure}{l}{\IfValueTF{#3}{#3}{#2}}
		\centering\includegraphics[width=#2]{figs/#1}\end{wrapfigure}}



\newcounter{usecounter}
\newcounter{altusecounter}
\setcounter{usecounter}{1}

\newcommand{\usecase}[9]{
	\def\tempa{#1}%
	\def\tempb{#2}%
	\def\tempc{#3}%
	\def\tempd{#4}%
	\def\tempe{#5}%
	\def\tempf{#6}%
	\def\tempg{#7}%
	\def\temph{#8}%
	\def\tempi{#9}%

\usecasecontinue
}

\newcommand\usecasecontinue[1]{%
	\begin{singlespace}
		\begin{table}[ht!]
			\setlength\extrarowheight{-5pt}
			\centering
			\begin{tabular}{|p{0.18\linewidth}|p{0.82\linewidth}|} 
				\hline
				\multicolumn{2}{|c|}{مورد کاربرد: {\tempa}}  \\ 
				\hline
				شناسه           &     \arabic{usecounter}                   \\ 
				\hline
				توضیح مختصر     &     \tempc                   \\ 
				\hline
				کنشگرهای اولیه  &     \tempd                   \\ 
				\hline
				کنشگرهای ثانویه &    \tempe                    \\ 
				\hline
				پیش‌نیازها      &     \tempf                  \\ 
				\hline
				روند اصلی       &    \tempg                    \\ 
				\hline
				پس‌نیاز‌ها      &     \temph                   \\ 
				\hline
				روند جایگزین    &  \tempi            \\
				\hline
			\end{tabular}
			\caption{#1}	
		\end{table}
	\stepcounter{usecounter}
	\setcounter{altusecounter}{1}
	\end{singlespace}
\FloatBarrier
\newpage
}



\newcommand{\alternativeflow}[8]{
	\def\tempa{#1}%
	\def\tempb{#2}%
	\def\tempc{#3}%
	\def\tempd{#4}%
	\def\tempe{#5}%
	\def\tempf{#6}%
	\def\tempg{#7}%
	\def\temph{#8}%
	
	\alternativeflowcontinue
}

\newcommand\alternativeflowcontinue[1]{%
	\addtocounter{usecounter}{-1}
	\begin{singlespace}
		\begin{table}[ht!]
			\setlength\extrarowheight{-5pt}
			\centering
			\begin{tabular}{|p{0.18\linewidth}|p{0.82\linewidth}|} 
				\hline
				\multicolumn{2}{|c|}{روند جایگزین: {\tempa}}  \\ 
				\hline
				شناسه           &     \arabic{altusecounter}.\arabic{usecounter}                      \\ 
				\hline
				توضیح مختصر     &     \tempc                   \\ 
				\hline
				کنشگرهای اولیه  &     \tempd                   \\ 
				\hline
				کنشگرهای ثانویه &    \tempe                    \\ 
				\hline
				پیش‌نیازها      &     \tempf                  \\ 
				\hline
				روند اصلی       &    \tempg                    \\ 
				\hline
				پس‌نیاز‌ها      &     \temph                   \\ 
				\hline
			\end{tabular}
			\caption{#1}	
		\end{table}
		\addtocounter{usecounter}{+1}
		\stepcounter{altusecounter}
	\end{singlespace}
\FloatBarrier
\newpage
	
}


\newcommand{\glossaryTitle}[1]{
	\hline
	\hline
	\multicolumn{2}{|c|}{}  \\
	\multicolumn{2}{|c|}{\linebreak \LARGE\textbf{{#1}}}  \\
	\multicolumn{2}{|c|}{}  \\ \hline \hline
	
}

\newcommand{\glossaryEntry}[4]{
	#1
	&
	\textbf{معنا} \hspace{1.53cm} #2
	
	\textbf{مترادف} \hspace{1cm} #3
	
	\textbf{متشابه}\hspace{1.28cm} #4
	\\
	\hline
	
}

\newcommand{\calendarEntry}[6]{
		#1 & #2 & $#3$ & ۱۴۰۱/#4 & ۱۴۰۱/#5 & #6\\
		\hline
}

\newcommand{\calendarEntryWithoutDep}[5]{
		#1 & #2 & $#3$ & ۱۴۰۱/#4 & ۱۴۰۱/#5\\
\hline
}


\newcommand{\calendarEntryWithName}[4]{
	#1 & #2 & $#3$ & #4\\
	\hline
}


\newcommand{\changelogEntry}[2]{
	 ۱۴۰۱/#1 & #2\\
	\hline
}


\newcommand{\cancelAlternativeFlow}[4]
{
	\alternativeflow
	% name
	{
		#1:انصراف
	}
	% id
	{#3}
	% brief description
	{
		#2 از #1 منصرف می‌شود.
	}
	% primary actos
	{
		#2
	}
	% secondary actors
	{}
	% preconditons
	{
		\begin{itemize}
			\vspace*{-0.6cm}
			\item 
			#2 در سیستم لاگین کرده باشد.
			\item
			#2 از #1 منصرف شده باشد.
		\end{itemize}
	}
	% main flow
	{
		\vspace*{-0.6cm}
		\begin{enumerate}
			\item 
			روند جایگزین می‌تواند هر موقع آغاز شود.
			\item
			#2 از #1 انصراف می‌دهد.
		\end{enumerate}
	}
	% postconditions
	{
		#4
	}
	% table name
	{
		روند جایگزین:#1:انصراف
	}
}







\newcommand{\crcheader}[4]{%
		\hline
		\multicolumn{2}{|c|}{\cellcolor[gray]{.8}نام: {#1}}                                             \\ \hline
		\multicolumn{2}{|r|}             {     \textbf{کلاس پدر: }  {#2}}          \\ \hline
		\multicolumn{2}{|r|}             {     \textbf{کلاس‌های فرزند:  } {#3}  }     \\ \hline
		\multicolumn{2}{|r|}             {     \textbf{توضیحات: }      {#4} }     \\ \hline
		\multicolumn{2}{|r|}{\cellcolor[gray]{.8}\textbf{صفات}}                    \\ \hline
}

\newcommand{\crcattritem}[1]{%
{#1} &                                \\ 
}

\newcommand{\crcrespheader}[0]{%
			\hline
			\multicolumn{1}{|r|}{\cellcolor[gray]{.8}\textbf{مسئولیت}} &{\cellcolor[gray]{.8} \textbf{همکاران}            }  \\ \hline
	
}
\newcommand{\crcrespitem}[2]{%
{#1}  & {#2}\\
}


\newcounter{usecasecrccounter}
\setcounter{usecasecrccounter}{0}
\newcommand{\usecasecrcitem}[2]{%
			 \stepcounter{usecasecrccounter}
	 \arabic{usecasecrccounter}  & {#1}  & {#2}\\ 
	\hline

}

